(function () {function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,o)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach(function(e){d(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var b={icon:"video",label:"HTML5 Video",props:{attrs:{type:Object},endpoints:Object,spellcheck:Boolean},data:function(){return{defaults:{lazyloading:!0,autoplay:!0,playsinline:!0,muted:!0,loop:!0,controls:!1}}},created:function(){console.log(this.defaults),this.$emit("input",{attrs:a(a({},this.defaults),this.attrs)})},computed:{style:function(){if(this.attrs.ratio)return"padding-bottom:"+100/this.attrs.ratio+"%"},fields:function(){return{alt:{label:this.$t("editor.blocks.html5video.alt.label"),type:"text",icon:"text"},css:{label:this.$t("editor.blocks.html5video.css.label"),type:"text",icon:"code"},lazyloading:{label:this.$t("editor.blocks.html5video.lazyloading.label"),type:"toggle"},autoplay:{label:this.$t("editor.blocks.html5video.autoplay.label"),type:"toggle"},playsinline:{label:this.$t("editor.blocks.html5video.playsinline.label"),type:"toggle"},loop:{label:this.$t("editor.blocks.html5video.loop.label"),type:"toggle"},muted:{label:this.$t("editor.blocks.html5video.muted.label"),type:"toggle"},controls:{label:this.$t("editor.blocks.html5video.controls.label"),type:"toggle"}}}},methods:{caption:function(t){this.input({caption:t})},edit:function(){this.attrs.guid&&this.$router.push(this.attrs.guid)},focus:function(){this.attrs.src?this.$refs.element.focus():this.$refs.element.$el.focus()},input:function(t){this.$emit("input",{attrs:a(a({},this.attrs),t)})},fetchFile:function(t){var e=this;this.$api.get(t).then(function(t){e.input({guid:t.link,src:t.url,id:t.id,ratio:t.dimensions.ratio})})},insertFile:function(t){var e=t[0];this.fetchFile(e.link)},insertUpload:function(t,e){this.fetchFile(e[0].link),this.$events.$emit("file.create"),this.$events.$emit("model.update"),this.$store.dispatch("notification/success",":)")},menu:function(){return this.attrs.src?[{icon:"open",label:this.$t("editor.blocks.html5video.open.browser"),click:this.open},{icon:"edit",label:this.$t("editor.blocks.html5video.open.panel"),click:this.edit,disabled:!this.attrs.guid},{icon:"cog",label:this.$t("editor.blocks.html5video.settings"),click:this.$refs.settings.open},{icon:"video",label:this.$t("editor.blocks.html5video.replace"),click:this.replace}]:[]},open:function(){window.open(this.attrs.src)},onDrop:function(t){this.$refs.fileUpload.drop(t,{url:window.panel.api+"/"+this.endpoints.field+"/upload",multiple:!1,accept:"video/*"})},onLoad:function(){var t=this.$refs.video;!this.attrs.ratio&&t&&t.videoWidth&&t.videoHeight&&this.input({ratio:t.videoWidth/t.videoHeight})},replace:function(){this.$emit("input",{attrs:{}})},selectFile:function(){this.$refs.fileDialog.open({endpoint:this.endpoints.field+"/files",multiple:!1,selected:[this.attrs.id]})},settings:function(){this.$refs.settings.open()},saveSettings:function(){this.$refs.settings.close(),this.input(this.attrs)},uploadFile:function(){this.$refs.fileUpload.open({url:window.panel.api+"/"+this.endpoints.field+"/upload",multiple:!1,accept:"video/*"})}}};if(typeof b==="function"){b=b.options}Object.assign(b,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("div",[_c("figure",[_vm.attrs.src?[_c("div",{ref:"element",staticClass:"k-editor-html5video-block-wrapper",style:_vm.style,attrs:{"data-responsive":_vm.attrs.ratio,"tabindex":"0"},on:{"keydown":[function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"delete",[8,46],$event.key,["Backspace","Delete","Del"])){return null}return _vm.$emit("remove")},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){return null}return _vm.$emit("append")},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"up",38,$event.key,["Up","ArrowUp"])){return null}return _vm.$emit("prev")},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"down",40,$event.key,["Down","ArrowDown"])){return null}return _vm.$emit("next")}]}},[_c("video",{key:_vm.attrs.src,ref:"video",attrs:{"src":_vm.attrs.src},on:{"dblclick":_vm.selectFile,"loadedmetadata":_vm.onLoad}})]),_vm._v(" "),_c("figcaption",[_c("k-editable",{attrs:{"content":_vm.attrs.caption,"breaks":true,"placeholder":_vm.$t("editor.blocks.html5video.caption.placeholder")+"\u2026","spellcheck":_vm.spellcheck},on:{"prev":_vm.focus,"shiftTab":_vm.focus,"tab":function($event){return _vm.$emit("next",$event)},"next":function($event){return _vm.$emit("next",$event)},"split":function($event){return _vm.$emit("append")},"enter":function($event){return _vm.$emit("append")},"input":_vm.caption}})],1)]:[_c("k-dropzone",{ref:"element",staticClass:"k-editor-html5video-block-placeholder",attrs:{"tabindex":"0"},on:{"drop":_vm.onDrop},nativeOn:{"keydown":[function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"delete",[8,46],$event.key,["Backspace","Delete","Del"])){return null}return _vm.$emit("remove")},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){return null}return _vm.$emit("append")},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"up",38,$event.key,["Up","ArrowUp"])){return null}$event.preventDefault();return _vm.$emit("prev")},function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"down",40,$event.key,["Down","ArrowDown"])){return null}$event.preventDefault();return _vm.$emit("next")}]}},[_c("k-button",{attrs:{"icon":"upload"},on:{"click":_vm.uploadFile},nativeOn:{"keydown":function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){return null}$event.stopPropagation()}}},[_vm._v(_vm._s(_vm.$t("editor.blocks.html5video.upload")))]),_vm._v(" "+_vm._s(_vm.$t("editor.blocks.html5video.or"))+" "),_c("k-button",{attrs:{"icon":"video"},on:{"click":_vm.selectFile},nativeOn:{"keydown":function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")){return null}$event.stopPropagation()}}},[_vm._v(_vm._s(_vm.$t("editor.blocks.html5video.select")))])],1)]],2),_vm._v(" "),_c("k-files-dialog",{ref:"fileDialog",on:{"submit":function($event){return _vm.insertFile($event)}}}),_vm._v(" "),_c("k-upload",{ref:"fileUpload",on:{"success":_vm.insertUpload}}),_vm._v(" "),_c("k-dialog",{ref:"settings",attrs:{"size":"medium"},on:{"submit":_vm.saveSettings}},[_c("k-form",{attrs:{"fields":_vm.fields},on:{"submit":_vm.saveSettings},model:{value:_vm.attrs,callback:function($$v){_vm.attrs=$$v},expression:"attrs"}})],1)],1)};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());editor.block("html5video",b);})();